<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday Paradox Sim <link rel="icon" href="../favicon.ico">

    </title>
    <style>
        :root {
            --bg-color: #f0f2f5;
            --card-bg: #ffffff;
            --accent: #6c5ce7;
            --danger: #fab1a0;
            --match-color: #ff7675;
            --text-color: #2d3436;
            --info: #74b9ff;
            --gold: #fdcb6e;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        h1 { margin-bottom: 5px; position: relative; z-index: 2; }
        p.subtitle { color: #636e72; margin-top: 0; margin-bottom: 30px; position: relative; z-index: 2; }

        /* --- NEW: Canvas Styles --- */
        #webCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; /* Lets clicks pass through to buttons */
            z-index: 0; /* Behind cards */
        }

        /* Controls Section */
        .controls {
            position: sticky;
            top: 20px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            gap: 15px;
            z-index: 100; /* Above canvas */
            margin-bottom: 30px;
            align-items: center;
            flex-wrap: wrap; 
            justify-content: center;
        }

        button {
            background-color: var(--accent);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.1s, opacity 0.2s, background-color 0.2s;
            font-weight: 600;
        }

        button:active { transform: scale(0.95); }
        button.secondary { background-color: #dfe6e9; color: var(--text-color); }
        button.delete { background-color: var(--danger); color: #d63031; }
        
        button.info { background-color: var(--info); border-radius: 50%; width: 40px; height: 40px; padding: 0; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; font-weight: bold; }

        button:disabled { 
            opacity: 0.6; 
            cursor: not-allowed; 
            transform: none; 
            background-color: #b2bec3 !important; 
            color: #636e72;
        }

        .stats {
            display: flex;
            flex-direction: column;
            text-align: center;
            min-width: 150px;
            font-variant-numeric: tabular-nums;
        }

        .stats span { font-size: 0.8rem; color: #636e72; }
        .stats strong { font-size: 1.2rem; }

        .room {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            max-width: 1000px;
            position: relative;
            z-index: 1; /* Above canvas */
        }

        .person-card {
            background: var(--card-bg);
            padding: 10px 15px;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 70px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 2px solid transparent;
            transition: border-color 0.3s, background-color 0.3s, transform 0.3s;
        }

        .person-card .emoji { font-size: 1.5rem; margin-bottom: 5px; }
        .person-card .date { font-size: 0.85rem; font-weight: 600; }

        .person-card.match {
            border-color: var(--match-color);
            background-color: #ffeaa7;
            transform: scale(1.1);
            z-index: 10;
        }

        /* --- MODALS (Shared Styles) --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            backdrop-filter: blur(3px);
        }
        
        .modal-overlay.active { opacity: 1; pointer-events: auto; }

        .modal-card {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            max-height: 85vh; 
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transform: translateY(20px);
            transition: transform 0.3s;
            text-align: left;
        }

        .modal-overlay.active .modal-card { transform: translateY(0); }
        .modal-card h2 { margin-top: 0; color: var(--accent); border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; }
        .modal-card h3 { margin-bottom: 5px; color: #2d3436; }
        .modal-card p { line-height: 1.6; color: #444; margin-top: 5px; }
        .modal-card .highlight { background: #dfe6e9; padding: 2px 5px; border-radius: 4px; font-weight: bold; }
        .close-btn { margin-top: 20px; width: 100%; background: #2d3436; }

        /* --- WIN MODAL SPECIFIC --- */
        #win-card { text-align: center; border: 4px solid var(--gold); }
        #win-card h2 { border: none; font-size: 2rem; margin-bottom: 10px; color: #2d3436; }
        #win-emoji { font-size: 4rem; display: block; margin: 10px 0; animation: shake 0.5s infinite; }
        #win-text { font-size: 1.1rem; color: #636e72; }
        #win-btn { background-color: var(--gold); color: #2d3436; }

        @keyframes popIn { from { opacity: 0; transform: scale(0.5); } to { opacity: 1; transform: scale(1); } }
        @keyframes shake { 0% { transform: rotate(0deg); } 25% { transform: rotate(5deg); } 75% { transform: rotate(-5deg); } 100% { transform: rotate(0deg); } }
    </style>
</head>
<body>

    <canvas id="webCanvas"></canvas>

    <h1>The Birthday Paradox</h1>
    <p class="subtitle">How many people until two share a birthday?</p>

    <div class="controls">
        <div class="stats">
            <span>People in room</span>
            <strong id="count">0</strong>
        </div>
        <div class="stats">
            <span>Theoretical Chance</span>
            <strong id="prob">0%</strong>
        </div>
        
        <button id="addBtn" onclick="addPerson()">+ Add Person</button>
        <button id="delBtn" class="delete" onclick="removePerson()">- Remove</button>
        <button class="secondary" onclick="resetSim()">Reset</button>
        <button class="info" onclick="toggleInfo()">?</button>
    </div>

    <div class="room" id="room"></div>

    <div class="modal-overlay" id="info-modal">
        <div class="modal-card">
            <h2>The Math Behind It</h2>
              The Birthday Paradox is the counterintuitive probability that in a small group (like 23 people), there's a greater than 50% chance that at least two individuals share the same birthday, a much smaller number than most people expect. <br>It's not a true paradox, but a surprising outcome of the number of possible pairings increasing rapidly, calculated by finding the probability of no shared birthdays and subtracting from 1.<br>
With n people, you‚Äôre not making n comparisons ‚Äî
you‚Äôre making n(n‚àí1)/2 pair checks. <br> 
For n = 23, that‚Äôs 253 independent chances
for two birthdays to overlap. <br> 
It‚Äôs easier to compute the chance that NO two match:
(365/365) √ó (364/365) √ó ... √ó (343/365) ‚âà 0.4927
So the chance that at least one match exists is:
1 ‚àí 0.4927 ‚âà 0.5073  (over 50%)
Big room ‚Üí lots of pairs ‚Üí surprisingly fast collisions.<br>
Generated by ChatGPT. 
            <button class="close-btn" onclick="toggleInfo()">Got it!</button>
        </div>
    </div>

    <div class="modal-overlay" id="win-modal">
        <div class="modal-card" id="win-card">
            <span id="win-emoji">üèÜ</span>
            <h2 id="win-title">Match Found!</h2>
            <p id="win-text">You found a match.</p>
            <p style="font-size: 0.9rem; color: #b2bec3;">(Click Reset to try again)</p>
            <button class="close-btn" id="win-btn" onclick="toggleWin()">Awesome!</button>
        </div>
    </div>

    <script>
        const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
        let people = []; 
        let winTimeout = null; 
        
        function getRandomDay() { return Math.floor(Math.random() * 365) + 1; }

        function getDateString(dayOfYear) {
            let day = dayOfYear;
            for (let i = 0; i < 12; i++) {
                let daysInMonth = 31;
                if (i === 1) daysInMonth = 28; 
                else if ([3, 5, 8, 10].includes(i)) daysInMonth = 30;
                if (day <= daysInMonth) return `${months[i]} ${day}`;
                day -= daysInMonth;
            }
            return "Dec 31";
        }

        function calculateProbability(n) {
            let noMatchProb = 1;
            for (let i = 0; i < n; i++) { noMatchProb *= (365 - i) / 365; }
            return ((1 - noMatchProb) * 100).toFixed(2);
        }

        function updateHighlights() {
            const counts = {};
            people.forEach(day => { counts[day] = (counts[day] || 0) + 1; });
            const cards = document.getElementsByClassName('person-card');
            let matchFound = false;
            for (let i = 0; i < cards.length; i++) {
                if (counts[people[i]] > 1) {
                    cards[i].classList.add('match');
                    matchFound = true;
                } else {
                    cards[i].classList.remove('match');
                }
            }
            return matchFound;
        }

        function updateStats() {
            document.getElementById('count').innerText = people.length;
            document.getElementById('prob').innerText = calculateProbability(people.length) + "%";
        }

        // --- NEW: DRAW WEB FUNCTION ---
        function drawWeb() {
            const canvas = document.getElementById('webCanvas');
            const ctx = canvas.getContext('2d');
            
            // Resize canvas to full window
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            // Clear previous lines
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Get positions of all cards
            const cards = document.getElementsByClassName('person-card');
            const points = [];
            
            for(let card of cards) {
                const rect = card.getBoundingClientRect();
                points.push({
                    x: rect.left + rect.width / 2,
                    y: rect.top + rect.height / 2
                });
            }

            // Style for lines
            ctx.strokeStyle = 'rgba(108, 92, 231, 0.15)'; // Faint purple
            ctx.lineWidth = 1;

            // Draw line from every point to every other point
            for (let i = 0; i < points.length; i++) {
                for (let j = i + 1; j < points.length; j++) {
                    ctx.beginPath();
                    ctx.moveTo(points[i].x, points[i].y);
                    ctx.lineTo(points[j].x, points[j].y);
                    ctx.stroke();
                }
            }
        }

        // Redraw when window resizes
        window.addEventListener('resize', drawWeb);

        function addPerson() {
            const dayNum = getRandomDay();
            const dateStr = getDateString(dayNum);
            people.push(dayNum);

            const card = document.createElement('div');
            card.className = 'person-card';
            const emojis = ['üòÉ', 'üòé', 'ü§ì', 'ü•≥', 'ü§†', 'ü§î', 'üò¥', 'üôÉ', 'üòØ', 'üßê'];
            card.innerHTML = `<span class="emoji">${emojis[Math.floor(Math.random() * emojis.length)]}</span><span class="date">${dateStr}</span>`;
            document.getElementById('room').appendChild(card);

            updateStats();
            
            // Draw lines immediately
            drawWeb();

            const isMatch = updateHighlights();

            if (isMatch) {
                const btn = document.getElementById('addBtn');
                btn.innerText = "Match Found!";
                btn.disabled = true; 
                
                const currentCount = people.length;
                winTimeout = setTimeout(() => {
                    triggerWinPopup(currentCount); 
                }, 1000); 
            }
        }

        function removePerson() {
            if (people.length === 0) return;
            people.pop(); 
            const room = document.getElementById('room');
            if (room.lastElementChild) room.lastElementChild.remove();
            
            updateStats();
            drawWeb(); // Update lines on remove
            
            if (!updateHighlights()) {
                const btn = document.getElementById('addBtn');
                btn.disabled = false;
                btn.innerText = "+ Add Person";
            }
        }

        function resetSim() {
            clearTimeout(winTimeout); 
            people = [];
            document.getElementById('room').innerHTML = '';
            
            updateStats();
            drawWeb(); // Clear lines
            
            const btn = document.getElementById('addBtn');
            btn.disabled = false;
            btn.innerText = "+ Add Person";
        }

        // --- POPUP LOGIC ---
        function toggleInfo() {
            document.getElementById('info-modal').classList.toggle('active');
        }

        function toggleWin() {
            document.getElementById('win-modal').classList.toggle('active');
        }

        function triggerWinPopup(count) {
            const title = document.getElementById('win-title');
            const text = document.getElementById('win-text');
            const emoji = document.getElementById('win-emoji');

            if (count <= 5) {
                emoji.innerText = "ü§Ø";
                title.innerText = "WHAT?!?! IMPOSSIBLE!";
                text.innerHTML = `AMAZING QEFABGVIKJDV YOOOOO!<br>You found a match in only <strong>${count} people</strong>.<br>The odds of this were practically zero!`;
            } else if (count <= 12) {
                emoji.innerText = "ü¶Ñ";
                title.innerText = "Super Rare!";
                text.innerHTML = `Wow! Only <strong>${count} people</strong>?<br>You are extremely lucky today.`;
            } else if (count < 23) {
                emoji.innerText = "üçÄ";
                title.innerText = "Lucky You!";
                text.innerHTML = `You found a match with <strong>${count} people</strong>.<br>That's faster than the statistical average (23).`;
            } else if (count <= 40) {
                emoji.innerText = "ü§ì";
                title.innerText = "Math Works!";
                text.innerHTML = `Match found at <strong>${count} people</strong>.<br>This is exactly where statistics says it should happen.`;
            } else {
                emoji.innerText = "üê¢";
                title.innerText = "Finally!";
                text.innerHTML = `It took <strong>${count} people</strong>.<br>A bit unlucky, but it happens!`;
            }

            toggleWin();
        }

        window.onclick = function(event) {
            if (event.target.classList.contains('modal-overlay')) {
                event.target.classList.remove('active');
            }
        }
    </script>
</body>

</html>
